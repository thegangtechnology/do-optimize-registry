# action.yml
name: 'doctl login'
description: 'Login to registry using doctl'
inputs:
  do-token:
    description: 'PAT for access registry'
    required: true
  registry-name:
    description: 'Image registry name'
    required: true

runs:
  using: 'composite'
  steps:
    - name: Install doctl
      uses: digitalocean/action-doctl@v2
      with:
        token: ${{ inputs.do-token}}

    - name: Run clean garbage-collection
      run: doctl registry garbage-collection start ${{ inputs.registry-name }} -f --include-untagged-manifests
